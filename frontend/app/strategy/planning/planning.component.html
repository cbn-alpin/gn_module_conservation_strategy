<mat-drawer-container>
  <mat-drawer
      mode="side"
      opened
  >
    <!-- <form>
      <fieldset>
        <h4 class="h5">Filtres</h4>

          <cs-organism-filter
            #organismFilter
            label="Organismes"
            [apiEndPoint]="baseApiEndpoint + '/organisms'"
            [apiParams]="{ 'id-organism': store.connectedOrganism?.id }"
            [parentFormControl]="filtersForm.controls.planningFilter"
            [charNumber]="3"
            [listLength]="20"
            (onChange)="onOrganismFilterChanged($event)"
          >
          </cs-organism-filter>

          <div
            class="alert alert-warning taxon-alert"
            *ngIf="filtersForm.selectedorganismFromComponent.length > 0"
          >
            <p class="organism-list">
              <b> Organisme(s) recherché(s):</b>
            </p>
            <ul class="organism-list">
              <li
                *ngFor="let organism of filtersForm.selectedorganismFromComponent; let i = index"
                class="d-flex justify-content-between align-items-center"
              >
                {{organism.nom_organisme}}
                <i
                  (click)="filtersForm.removeOrganism(i, filtersForm.selectedorganismFromComponent)"
                  class="fa fa-times clickable"
                  matTooltip="Retirer « {{organism.nom_organisme}} » des filtres de recherche"
                ></i>
              </li>
            </ul>
          </div>


        <mat-label>Etat d'avancement</mat-label>
        <mat-select
          name="progress"
          [formControl]="filtersForm.controls.progressFilter"
          (selectionChange)="onProgressFilterChanged($event)"
        >
          <mat-checkbox value="687"> A mettre en place</mat-checkbox>
          <mat-checkbox value="688"> En cours</mat-checkbox>
          <mat-checkbox value="689"> Mis en place</mat-checkbox>
        </mat-select>

        <mat-label>Tâches</mat-label>
        <mat-select
          name="task"
          [formControl]="filtersForm.controls.taskFilter"
          (change)="onTaskFilterChanged($event)"
        >
          <mat-checkbox value="1"> Actions</mat-checkbox>
          <mat-checkbox value="2"> Bilans Stationnels</mat-checkbox>
        </mat-select>
      </fieldset>
    </form> -->
  </mat-drawer>

  <mat-drawer-content>
    <div class="cs-tasks-datatable-progress-bar-container" >
      <mat-progress-bar mode="query" *ngIf="dataSource.loading$ | async"></mat-progress-bar>
    </div>
    <div #dataTableContainer class="mat-elevation-z8" [ngStyle]="{ 'height': dataTableHeight + 'px' }">
      <table
        mat-table
        [dataSource]="dataSource"
        matSort
        matSortActive="taskDate"
        matSortDirection="desc"
        matSortDisableClear
      >
        <ng-container matColumnDef="taskType">
          <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
          >
            Type de tâche
          </th>
          <td
          mat-cell
          *matCellDef="let task">Action
          </td>
        </ng-container>

        <ng-container matColumnDef="taxonName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Taxon prioritaire </th>
          <td mat-cell *matCellDef="let task">
            <i>{{task.shortName}}</i>
          </td>
        </ng-container>

        <ng-container matColumnDef="territory">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
          >
            Territoire
          </th>
          <td mat-cell *matCellDef="let task">{{task.territoryName}}
          </td>
        </ng-container>

        <ng-container matColumnDef="toDo">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            matTooltip="Nombre total de zone de prospection pour un taxon dans un territoire."
          >
            Tâche à réaliser
          </th>
          <td mat-cell class="text-center" *matCellDef="let task"> {{task.actionLabel}} </td>
        </ng-container>

        <ng-container matColumnDef="progressStatus">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Etat d'avancement </th>
          <td mat-cell *matCellDef="let task"> {{task.progressStatus}} </td>
        </ng-container>

        <ng-container matColumnDef="previousDate">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            matTooltip="Date la plus ancienne d'inventaire de zone de prospection pour un taxon dans un territoire."
          >
            Date précédente
          </th>
          <td mat-cell *matCellDef="let task"> {{task.implementationDate | date}} </td>
        </ng-container>

        <ng-container matColumnDef="taskDate">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            matTooltip="Date la plus récente d'inventaire de zone de prospection pour un taxon dans un territoire."
          >
            Date
          </th>
          <td mat-cell *matCellDef="let task"> {{task.yearAction}} </td>
        </ng-container>


        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let task">
            <div class="d-flex justify-content-end flex-wrap">
              <button
                mat-icon-button
                matRipple
                matTooltip="Voir la fiche détaillée du bilan stationnel."
                [routerLink]="[
                  task.idAssessment,
                  { shortName: task.shortName }
                ]"
              >
                <mat-icon>description</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <mat-paginator
        class="mat-paginator-sticky"
        showFirstLastButtons
        [length]="dataSource.itemsCount$ | async"
        [pageSize]="20"
        [pageSizeOptions]="[10, 20, 50]"
      ></mat-paginator>
    </div>
  </mat-drawer-content>
</mat-drawer-container>
